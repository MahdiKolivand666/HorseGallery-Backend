# ๐ง ุฑุงูููุง ุงุตูุงุญ ูุญุตููุงุช ูุฑุชุจุท - Frontend

ุชุงุฑุฎ: ุฏุณุงูุจุฑ 2024  
ูุถุนุช: โ Backend ุงุตูุงุญ ุดุฏู - Frontend ูุงุฒ ุจู ุชุบุฑ ูุฏุงุฑุฏ

---

## ๐ ุฎูุงุตู ูุดฺฉู

**ูุดฺฉู:** ุฏุฑ ุตูุญู ุฌุฒุฆุงุช ูุญุตููุ ูุญุตููุงุช ูุฑุชุจุท (Related Products) ุจู ุฏุฑุณุช ููุชุฑ ููโุดุฏูุฏ:

- ุฏุฑ ุตูุญู ุฌุฒุฆุงุช ุณฺฉูุ ูุญุตููุงุช ุฌูุงูุฑุงุช ู ุดูุด ูู ููุงุด ุฏุงุฏู ูโุดุฏูุฏ
- ุฏุฑ ุตูุญู ุฌุฒุฆุงุช ุดูุดุ ูุญุตููุงุช ุฌูุงูุฑุงุช ู ุณฺฉู ูู ููุงุด ุฏุงุฏู ูโุดุฏูุฏ
- ุฏุฑ ุตูุญู ุฌุฒุฆุงุช ุฌูุงูุฑุงุชุ ุณฺฉู ู ุดูุด ูู ููุงุด ุฏุงุฏู ูโุดุฏูุฏ

**ุฑุงูโุญู:** Backend ุงุตูุงุญ ุดุฏ ุชุง ูุญุตููุงุช ูุฑุชุจุท ููุท ุงุฒ ููุงู `productType` ููุงุด ุฏุงุฏู ุดููุฏ.

---

## โ ุชุบุฑุงุช Backend

### 1. ุงุตูุงุญ ูุชุฏ `findAll` ุฏุฑ `ProductService`

**ูุจู:**

```typescript
// Product Type filter
if (productType) {
  query.productType = productType;
}
// ุงฺฏุฑ productType ูุดุฎุต ูุดุฏู ุจูุฏุ ููู ูุญุตููุงุช ุจุฑูโฺฏุดุช
```

**ุจุนุฏ:**

```typescript
// Product Type filter - ูพุดโูุฑุถ: ููุท jewelry
if (productType) {
  query.productType = productType;
} else {
  // ุงฺฏุฑ productType ูุดุฎุต ูุดุฏูุ ููุท ูุญุตููุงุช jewelry ุฑุง ุจุฑฺฏุฑุฏุงู
  // (ุณฺฉู ู ุดูุด ุจุงุฏ ุตุฑุญุงู ุฏุฑุฎูุงุณุช ุดููุฏ)
  query.productType = 'jewelry';
}
```

### 2. ุจูุจูุฏ ฺฉูุชุฑูุฑ `PublicProductController`

ูุญุตููุงุช ูุฑุชุจุท ุญุงูุง ุจุฑ ุงุณุงุณ `productType` ูุญุตูู ูุนู ููุชุฑ ูโุดููุฏ:

```typescript
// Get current product type to filter related products
const currentProductType = (product as any).productType || 'jewelry';

// Get related products from same category AND same productType
let relatedProducts = await this.productService.findAll({
  category: categoryId,
  exclude: productId ? [productId] : [],
  limit: 8,
  productType: currentProductType, // โ๏ธ ููุชุฑ ุจุฑ ุงุณุงุณ ููุน ูุญุตูู - ุงุฌุจุงุฑ!
});
```

### 3. ุงุตูุงุญ ฺฉูุชุฑูุฑ `SiteProductController`

ููุงู ููุชุฑ `productType` ุจู ุงู ฺฉูุชุฑูุฑ ูู ุงุถุงูู ุดุฏ.

---

## ๐ฏ ูุชุฌู

ุญุงูุง ูุญุตููุงุช ูุฑุชุจุท ุจู ุฏุฑุณุช ููุชุฑ ูโุดููุฏ:

- โ **ุตูุญู ุฌุฒุฆุงุช ุณฺฉู** โ ููุท ุณฺฉูโูุง ูุฑุชุจุท ููุงุด ุฏุงุฏู ูโุดููุฏ
- โ **ุตูุญู ุฌุฒุฆุงุช ุดูุด** โ ููุท ุดูุดโูุง ูุฑุชุจุท ููุงุด ุฏุงุฏู ูโุดููุฏ
- โ **ุตูุญู ุฌุฒุฆุงุช ุฌูุงูุฑุงุช** โ ููุท ุฌูุงูุฑุงุช ูุฑุชุจุท ููุงุด ุฏุงุฏู ูโุดููุฏ
- โ **ุณฺฉู ู ุดูุด** ุฏุฑ ูุญุตููุงุช ูุฑุชุจุท ุฌูุงูุฑุงุช ููุงุด ุฏุงุฏู ููโุดููุฏ

---

## ๐ป ุชุบุฑุงุช ููุฑุฏ ูุงุฒ ุฏุฑ Frontend

### โ๏ธ ุฎุจุฑ ุฎูุจ: **ูฺ ุชุบุฑ ูุงุฒู ูุณุช!**

Backend ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ูุญุตููุงุช ูุฑุชุจุท ุฑุง ุจุฑ ุงุณุงุณ `productType` ููุชุฑ ูโฺฉูุฏ. Frontend ููุท ุจุงุฏ ุงุฒ API ุงุณุชูุงุฏู ฺฉูุฏ ู ูุงุฒ ุจู ุชุบุฑ ฺฉุฏ ูุฏุงุฑุฏ.

### ุงูุง ุงฺฏุฑ ูโุฎูุงูุฏ ูุทูุฆู ุดูุฏ:

#### 1. ุจุฑุฑุณ Response API

ููุช ูุญุตูู ุฑุง ุงุฒ API ุฏุฑุงูุช ูโฺฉูุฏุ `productType` ุฏุฑ response ูุฌูุฏ ุฏุงุฑุฏ:

```typescript
// GET /product/public/:slug
{
  "_id": "...",
  "name": "ุณฺฉู ุชูุงู ุจูุงุฑ ุขุฒุงุฏ",
  "slug": "coin-bahar-azadi-full",
  "productType": "coin", // โจ ุงู ููุฏ ูุฌูุฏ ุฏุงุฑุฏ
  "relatedProducts": [
    // ููุท ุณฺฉูโูุง ุฏฺฏุฑ - ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ููุชุฑ ุดุฏู
    {
      "_id": "...",
      "name": "ุณฺฉู ูู ุจูุงุฑ ุขุฒุงุฏ",
      "productType": "coin"
    }
  ]
}
```

#### 2. ุจุฑุฑุณ Type Definitions

ูุทูุฆู ุดูุฏ ฺฉู `productType` ุฏุฑ interface Product ุดูุง ูุฌูุฏ ุฏุงุฑุฏ:

```typescript
// src/types/product.ts
export interface Product {
  _id: string;
  name: string;
  slug: string;
  // ... ุณุงุฑ ููุฏูุง

  productType: 'jewelry' | 'coin' | 'melted_gold'; // โจ ุจุงุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ
  relatedProducts?: Product[]; // โจ ูุญุตููุงุช ูุฑุชุจุท
}
```

#### 3. ุงุณุชูุงุฏู ุฏุฑ ฺฉุงููพูููุช

ฺฉุงููพูููุช ุดูุง ุจุงุฏ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ฺฉุงุฑ ฺฉูุฏ:

```typescript
// components/ProductDetail.tsx
import { Product } from '@/types/product';

interface ProductDetailProps {
  product: Product;
}

export default function ProductDetail({ product }: ProductDetailProps) {
  return (
    <div>
      <h1>{product.name}</h1>

      {/* ููุงุด ูุญุตููุงุช ูุฑุชุจุท */}
      {product.relatedProducts && product.relatedProducts.length > 0 && (
        <div className="related-products">
          <h2>ูุญุตููุงุช ูุฑุชุจุท</h2>
          <div className="grid">
            {product.relatedProducts.map((related) => (
              <ProductCard key={related._id} product={related} />
            ))}
          </div>
        </div>
      )}
    </div>
  );
}
```

---

## ๐ ูุซุงูโูุง Response

### ูุซุงู 1: ุตูุญู ุฌุฒุฆุงุช ุณฺฉู

**Request:**

```bash
GET /product/public/coin-bahar-azadi-full
```

**Response:**

```json
{
  "_id": "6758xxxxx",
  "name": "ุณฺฉู ุชูุงู ุจูุงุฑ ุขุฒุงุฏ",
  "slug": "coin-bahar-azadi-full",
  "productType": "coin",
  "price": 50000000,
  "goldInfo": {
    "weight": 8.13,
    "purity": "900",
    "mintYear": 2024
  },
  "relatedProducts": [
    {
      "_id": "6758yyyyy",
      "name": "ุณฺฉู ูู ุจูุงุฑ ุขุฒุงุฏ",
      "slug": "coin-bahar-azadi-half",
      "productType": "coin",
      "price": 27000000
    },
    {
      "_id": "6758zzzzz",
      "name": "ุณฺฉู ุฑุจุน ุจูุงุฑ ุขุฒุงุฏ",
      "slug": "coin-bahar-azadi-quarter",
      "productType": "coin",
      "price": 14500000
    }
    // ููุท ุณฺฉูโูุง - ุฌูุงูุฑุงุช ู ุดูุด ููุงุด ุฏุงุฏู ููโุดููุฏ
  ]
}
```

### ูุซุงู 2: ุตูุญู ุฌุฒุฆุงุช ุดูุด

**Request:**

```bash
GET /product/public/gold-bar-10g
```

**Response:**

```json
{
  "_id": "6758aaaaa",
  "name": "ุดูุด ุทูุง 10 ฺฏุฑู",
  "slug": "gold-bar-10g",
  "productType": "melted_gold",
  "price": 15000000,
  "goldInfo": {
    "weight": 10,
    "purity": "999.9",
    "manufacturer": "ุจุงูฺฉ ูุฑฺฉุฒ"
  },
  "relatedProducts": [
    {
      "_id": "6758bbbbb",
      "name": "ุดูุด ุทูุง 20 ฺฏุฑู",
      "slug": "gold-bar-20g",
      "productType": "melted_gold",
      "price": 30000000
    }
    // ููุท ุดูุดโูุง - ุฌูุงูุฑุงุช ู ุณฺฉู ููุงุด ุฏุงุฏู ููโุดููุฏ
  ]
}
```

### ูุซุงู 3: ุตูุญู ุฌุฒุฆุงุช ุฌูุงูุฑุงุช

**Request:**

```bash
GET /product/public/ring-gold-18k
```

**Response:**

```json
{
  "_id": "6758ccccc",
  "name": "ุงูฺฏุดุชุฑ ุทูุง 18 ุนุงุฑ",
  "slug": "ring-gold-18k",
  "productType": "jewelry",
  "price": 5000000,
  "relatedProducts": [
    {
      "_id": "6758ddddd",
      "name": "ุงูฺฏุดุชุฑ ุทูุง 21 ุนุงุฑ",
      "slug": "ring-gold-21k",
      "productType": "jewelry",
      "price": 6000000
    }
    // ููุท ุฌูุงูุฑุงุช - ุณฺฉู ู ุดูุด ููุงุด ุฏุงุฏู ููโุดููุฏ
  ]
}
```

---

## โ ฺฺฉโูุณุช Frontend

ุจุฑุง ุงุทููุงู ุงุฒ ุงูฺฉู ููู ฺุฒ ุฏุฑุณุช ฺฉุงุฑ ูโฺฉูุฏ:

- [ ] ุจุฑุฑุณ ฺฉูุฏ ฺฉู `productType` ุฏุฑ interface Product ุดูุง ูุฌูุฏ ุฏุงุฑุฏ
- [ ] ุจุฑุฑุณ ฺฉูุฏ ฺฉู `relatedProducts` ุฏุฑ interface Product ุดูุง ูุฌูุฏ ุฏุงุฑุฏ
- [ ] ุชุณุช ฺฉูุฏ ฺฉู ุฏุฑ ุตูุญู ุฌุฒุฆุงุช ุณฺฉูุ ููุท ุณฺฉูโูุง ูุฑุชุจุท ููุงุด ุฏุงุฏู ูโุดููุฏ
- [ ] ุชุณุช ฺฉูุฏ ฺฉู ุฏุฑ ุตูุญู ุฌุฒุฆุงุช ุดูุดุ ููุท ุดูุดโูุง ูุฑุชุจุท ููุงุด ุฏุงุฏู ูโุดููุฏ
- [ ] ุชุณุช ฺฉูุฏ ฺฉู ุฏุฑ ุตูุญู ุฌุฒุฆุงุช ุฌูุงูุฑุงุชุ ููุท ุฌูุงูุฑุงุช ูุฑุชุจุท ููุงุด ุฏุงุฏู ูโุดููุฏ
- [ ] ุชุณุช ฺฉูุฏ ฺฉู ุณฺฉู ู ุดูุด ุฏุฑ ูุญุตููุงุช ูุฑุชุจุท ุฌูุงูุฑุงุช ููุงุด ุฏุงุฏู ููโุดููุฏ

---

## ๐ ุฑูุน ูุดฺฉูุงุช ุงุญุชูุงู

### ูุดฺฉู 1: `relatedProducts` ุฎุงู ุงุณุช

**ุนูุช:** ููฺฉู ุงุณุช ูุญุตููุงุช ูุฑุชุจุท ุจุง ููุงู `productType` ุฏุฑ ุฏุชุงุจุณ ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ.

**ุฑุงูโุญู:** ุงู ุทุจุน ุงุณุช. ุงฺฏุฑ ูุญุตููุงุช ูุฑุชุจุท ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุขุฑุงู ุฎุงู ุจุฑูโฺฏุฑุฏุฏ.

```typescript
// โ ุฏุฑุณุช - ฺฺฉ ฺฉูุฏ ฺฉู ุขุฑุงู ุฎุงู ูุจุงุดุฏ
{product.relatedProducts && product.relatedProducts.length > 0 && (
  <RelatedProducts products={product.relatedProducts} />
)}
```

### ูุดฺฉู 2: `productType` undefined ุงุณุช

**ุนูุช:** ููฺฉู ุงุณุช ูุญุตูู ูุฏู ุจุงุดุฏ ฺฉู `productType` ูุฏุงุฑุฏ.

**ุฑุงูโุญู:** Backend ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ `productType` ุฑุง ุจู `jewelry` ุชูุธู ูโฺฉูุฏ.

```typescript
// โ ุฏุฑุณุช - ุงุฒ optional chaining ุงุณุชูุงุฏู ฺฉูุฏ
const productType = product.productType || 'jewelry';
```

### ูุดฺฉู 3: ูุญุตููุงุช ูุฑุชุจุท ุงุฒ ููุน ูุชูุงูุช ููุงุด ุฏุงุฏู ูโุดููุฏ

**ุนูุช:** ููฺฉู ุงุณุช cache ุดุฏู ุจุงุดุฏ ุง ุงุฒ API ูุฏู ุงุณุชูุงุฏู ูโฺฉูุฏ.

**ุฑุงูโุญู:**

1. Cache ุฑุง ูพุงฺฉ ฺฉูุฏ
2. ูุทูุฆู ุดูุฏ ฺฉู ุงุฒ ุขุฎุฑู ูุณุฎู Backend ุงุณุชูุงุฏู ูโฺฉูุฏ
3. Response ุฑุง ุฏุฑ Network tab ุจุฑุฑุณ ฺฉูุฏ

---

## ๐ ุฎูุงุตู

### ุชุบุฑุงุช Backend:

- โ ูุชุฏ `findAll` ุงุตูุงุญ ุดุฏ ุชุง ูพุดโูุฑุถ ููุท `jewelry` ุจุฑฺฏุฑุฏุงูุฏ
- โ ูุญุตููุงุช ูุฑุชุจุท ุจุฑ ุงุณุงุณ `productType` ููุชุฑ ูโุดููุฏ
- โ ููู ฺฉูุชุฑูุฑูุง ุจูโุฑูุฒุฑุณุงู ุดุฏูุฏ

### ุชุบุฑุงุช Frontend:

- โ **ูฺ ุชุบุฑ ูุงุฒู ูุณุช!** Backend ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ููุชุฑ ูโฺฉูุฏ
- โ ููุท ูุทูุฆู ุดูุฏ ฺฉู `productType` ุฏุฑ Type definitions ุดูุง ูุฌูุฏ ุฏุงุฑุฏ
- โ Response ุฑุง ุจุฑุฑุณ ฺฉูุฏ ุชุง ูุทูุฆู ุดูุฏ ฺฉู ูุญุตููุงุช ูุฑุชุจุท ุฏุฑุณุช ููุชุฑ ุดุฏูโุงูุฏ

---

## ๐ ุชุณุช

ุจุฑุง ุชุณุช ฺฉุฑุฏู:

1. **ุชุณุช ุตูุญู ุฌุฒุฆุงุช ุณฺฉู:**

   ```bash
   GET http://localhost:4001/product/public/coin-bahar-azadi-full
   ```

   ุจุฑุฑุณ ฺฉูุฏ ฺฉู `relatedProducts` ููุท ุดุงูู ุณฺฉูโูุง ุจุงุดุฏ.

2. **ุชุณุช ุตูุญู ุฌุฒุฆุงุช ุดูุด:**

   ```bash
   GET http://localhost:4001/product/public/gold-bar-10g
   ```

   ุจุฑุฑุณ ฺฉูุฏ ฺฉู `relatedProducts` ููุท ุดุงูู ุดูุดโูุง ุจุงุดุฏ.

3. **ุชุณุช ุตูุญู ุฌุฒุฆุงุช ุฌูุงูุฑุงุช:**
   ```bash
   GET http://localhost:4001/product/public/ring-gold-18k
   ```
   ุจุฑุฑุณ ฺฉูุฏ ฺฉู `relatedProducts` ููุท ุดุงูู ุฌูุงูุฑุงุช ุจุงุดุฏ ู ุณฺฉู/ุดูุด ูุฏุงุดุชู ุจุงุดุฏ.

---

## ๐ ูพุดุชุจุงู

ุงฺฏุฑ ูุดฺฉู ุฏุงุดุชุฏ:

1. โ ุจุฑุฑุณ ฺฉูุฏ ฺฉู Backend ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช (`http://localhost:4001`)
2. โ Response ุฑุง ุฏุฑ Console/Network tab ุจุฑุฑุณ ฺฉูุฏ
3. โ ูุทูุฆู ุดูุฏ ฺฉู `productType` ุฏุฑ Response ูุฌูุฏ ุฏุงุฑุฏ
4. โ Cache ุฑุง ูพุงฺฉ ฺฉูุฏ ู ุฏูุจุงุฑู ุชุณุช ฺฉูุฏ

---

**ูููู ุจุงุดุฏ! ๐**
